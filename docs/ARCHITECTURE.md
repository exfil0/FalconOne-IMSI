# FalconOne Architecture Documentation

## System Overview

FalconOne is a comprehensive SIGINT research platform for cellular network security analysis.

---

## Module Dependency Graph

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           FalconOne Architecture                             │
│                                  v1.9.2                                      │
└─────────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────┐
│                              PRESENTATION LAYER                              │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐     │
│  │  Dashboard  │   │    CLI      │   │  REST API   │   │  WebSocket  │     │
│  │  (Flask)    │   │  (Click)    │   │  Endpoints  │   │   Events    │     │
│  └──────┬──────┘   └──────┬──────┘   └──────┬──────┘   └──────┬──────┘     │
└─────────┼─────────────────┼─────────────────┼─────────────────┼─────────────┘
          │                 │                 │                 │
          └────────────────────────┬───────────────────────────┘
                                   │
                                   ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            ORCHESTRATION LAYER                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                    ┌─────────────────────────────┐                          │
│                    │    FalconOneOrchestrator    │                          │
│                    │  (Core System Controller)   │                          │
│                    └──────────────┬──────────────┘                          │
│                                   │                                          │
│     ┌────────────┬────────────┬───┴───┬────────────┬────────────┐          │
│     ▼            ▼            ▼       ▼            ▼            ▼          │
│  ┌──────┐   ┌──────┐    ┌──────┐  ┌──────┐   ┌──────┐    ┌──────┐         │
│  │Config│   │Logger│    │Crypto│  │Health│   │Events│    │Tasks │         │
│  │Mgr   │   │      │    │Mgr   │  │Check │   │Bus   │    │Queue │         │
│  └──────┘   └──────┘    └──────┘  └──────┘   └──────┘    └──────┘         │
└─────────────────────────────────────────────────────────────────────────────┘
                                   │
          ┌────────────────────────┼────────────────────────┐
          │                        │                        │
          ▼                        ▼                        ▼
┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐
│   MONITORING LAYER  │  │  EXPLOITATION LAYER │  │   ANALYSIS LAYER    │
├─────────────────────┤  ├─────────────────────┤  ├─────────────────────┤
│                     │  │                     │  │                     │
│  ┌───────────────┐  │  │  ┌───────────────┐  │  │  ┌───────────────┐  │
│  │  GSM Monitor  │  │  │  │   Exploit     │  │  │  │    Signal     │  │
│  │  (gr-gsm)     │  │  │  │   Engine      │  │  │  │  Classifier   │  │
│  └───────┬───────┘  │  │  └───────┬───────┘  │  │  │  (CNN+LSTM)   │  │
│          │          │  │          │          │  │  └───────┬───────┘  │
│  ┌───────────────┐  │  │  ┌───────────────┐  │  │          │          │
│  │  LTE Monitor  │  │  │  │   SUCI        │  │  │  ┌───────────────┐  │
│  │  (srsRAN)     │  │  │  │  Deconceal    │  │  │  │  Geolocation  │  │
│  └───────┬───────┘  │  │  └───────────────┘  │  │  │      3D       │  │
│          │          │  │                     │  │  └───────┬───────┘  │
│  ┌───────────────┐  │  │  ┌───────────────┐  │  │          │          │
│  │  5G/6G Monitor│  │  │  │  Quantum-Safe │  │  │  ┌───────────────┐  │
│  │  (nr-scope)   │  │  │  │    Crypto     │  │  │  │     NTN       │  │
│  └───────────────┘  │  │  └───────────────┘  │  │  │   Modeler     │  │
│                     │  │                     │  │  └───────────────┘  │
└─────────────────────┘  └─────────────────────┘  └─────────────────────┘
          │                        │                        │
          └────────────────────────┼────────────────────────┘
                                   │
                                   ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                            INFRASTRUCTURE LAYER                              │
├─────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │   Circuit   │  │   Async     │  │  CodeCarbon │  │   Dataset   │        │
│  │  Breaker    │  │  Monitor    │  │   Tracker   │  │   Loader    │        │
│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘        │
│         │                │                │                │                │
│  ┌──────┴──────┐  ┌──────┴──────┐  ┌──────┴──────┐  ┌──────┴──────┐        │
│  │ Protected   │  │   Task      │  │   Energy    │  │  RadioML    │        │
│  │ Subprocess  │  │  Monitor    │  │  Estimator  │  │  Datasets   │        │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘        │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## Data Flow Diagram

### IMSI Capture Flow

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        IMSI CAPTURE DATA FLOW                            │
└─────────────────────────────────────────────────────────────────────────┘

  ┌──────────┐
  │   SDR    │ HackRF/USRP/BladeRF
  │ Hardware │
  └────┬─────┘
       │ Raw I/Q Samples
       │ (8-16 bit, 2-20 MSPS)
       ▼
  ┌──────────────────┐
  │   SDR Driver     │ UHD / libhackrf / SoapySDR
  │   Interface      │
  └────────┬─────────┘
           │ Complex Float32 Samples
           ▼
  ┌──────────────────┐    ┌──────────────────┐
  │  Signal Filter   │───►│  Circuit Breaker │
  │  & Decimation    │    │  (Fault Tolerant)│
  └────────┬─────────┘    └──────────────────┘
           │ Filtered Baseband
           ▼
  ┌──────────────────┐
  │  Protocol        │ GSM / LTE / 5G NR Detection
  │  Detection       │
  └────────┬─────────┘
           │
     ┌─────┴─────┐
     ▼           ▼
┌─────────┐ ┌─────────┐
│   GSM   │ │   LTE   │
│ Decoder │ │ Decoder │
│ (gr-gsm)│ │(srsRAN) │
└────┬────┘ └────┬────┘
     │           │
     └─────┬─────┘
           │ L3 Messages
           ▼
  ┌──────────────────┐
  │   IMSI/TMSI      │
  │   Extraction     │
  └────────┬─────────┘
           │
     ┌─────┴─────┐
     ▼           ▼
┌─────────┐ ┌─────────────┐
│  IMSI   │ │    SUCI     │
│ (2G/3G) │ │  (5G SA)    │
└────┬────┘ └──────┬──────┘
     │             │
     │       ┌─────▼─────┐
     │       │   SUCI    │ AI-powered de-concealment
     │       │ Deconceal │
     │       └─────┬─────┘
     │             │
     └──────┬──────┘
            ▼
  ┌──────────────────┐
  │    Capture       │
  │    Database      │ SQLCipher Encrypted
  └────────┬─────────┘
           │
     ┌─────┴─────┬────────────┐
     ▼           ▼            ▼
┌─────────┐ ┌─────────┐ ┌──────────┐
│Dashboard│ │ Alerts  │ │Analytics │
│   UI    │ │(Webhook)│ │ Reports  │
└─────────┘ └─────────┘ └──────────┘
```

---

### Geolocation Processing Flow

```
┌─────────────────────────────────────────────────────────────────────────┐
│                     GEOLOCATION PROCESSING FLOW                          │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                         INPUT SOURCES                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌──────────┐   ┌──────────┐   ┌──────────┐   ┌──────────┐            │
│   │  TDOA    │   │   AoA    │   │   RSSI   │   │   NTN    │            │
│   │Timing Diff│   │Angle Arr.│   │  Power   │   │Satellite │            │
│   └────┬─────┘   └────┬─────┘   └────┬─────┘   └────┬─────┘            │
│        │              │              │              │                    │
└────────┼──────────────┼──────────────┼──────────────┼────────────────────┘
         │              │              │              │
         └──────────────┴──────────────┴──────────────┘
                                │
                                ▼
                    ┌───────────────────────┐
                    │   Geolocation3D       │
                    │   Engine (v1.9.2)     │
                    └───────────┬───────────┘
                                │
         ┌──────────────────────┼──────────────────────┐
         │                      │                      │
         ▼                      ▼                      ▼
┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐
│    MUSIC DoA    │   │   3D TDOA       │   │   NTN Altitude  │
│   Estimation    │   │  Multilateration │   │    Modeler     │
├─────────────────┤   ├─────────────────┤   ├─────────────────┤
│ • Steering vec  │   │ • Hyperbolic    │   │ • LEO/MEO/GEO   │
│ • Eigenvalue    │   │   intersection  │   │ • Doppler comp  │
│   decomposition │   │ • WGS-84 ECEF   │   │ • Ionospheric   │
│ • Peak finding  │   │ • Weighted LSQ  │   │ • Tropospheric  │
└────────┬────────┘   └────────┬────────┘   └────────┬────────┘
         │                     │                     │
         └──────────────┬──────┴──────────────┬──────┘
                        │                     │
                        ▼                     ▼
              ┌─────────────────┐   ┌─────────────────┐
              │  Sensor Fusion  │   │  Kalman Filter  │
              │  (Multi-source) │   │  (Prediction)   │
              └────────┬────────┘   └────────┬────────┘
                       │                     │
                       └──────────┬──────────┘
                                  │
                                  ▼
                      ┌───────────────────────┐
                      │      Location3D       │
                      ├───────────────────────┤
                      │ • Latitude            │
                      │ • Longitude           │
                      │ • Altitude            │
                      │ • Horizontal Accuracy │
                      │ • Vertical Accuracy   │
                      │ • Confidence Score    │
                      │ • Velocity Vector     │
                      └───────────────────────┘
```

---

### AI/ML Pipeline

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         AI/ML PROCESSING PIPELINE                        │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                           DATA INGESTION                                 │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌──────────────┐   ┌──────────────┐   ┌──────────────┐               │
│   │  RadioML     │   │  GSM/LTE     │   │  Real-time   │               │
│   │  2016/2018   │   │  Captures    │   │  SDR Stream  │               │
│   └──────┬───────┘   └──────┬───────┘   └──────┬───────┘               │
│          │                  │                  │                        │
│          └──────────────────┴──────────────────┘                        │
│                             │                                           │
│                             ▼                                           │
│                  ┌───────────────────────┐                              │
│                  │   RealDatasetLoader   │                              │
│                  │   (v1.9.2)            │                              │
│                  └───────────┬───────────┘                              │
│                              │                                          │
└──────────────────────────────┼──────────────────────────────────────────┘
                               │
                               ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                         DATA PREPROCESSING                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   ┌──────────────────────────────────────────────────────────────┐      │
│   │                    Augmentation Pipeline                      │      │
│   ├──────────────────────────────────────────────────────────────┤      │
│   │                                                              │      │
│   │  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │      │
│   │  │  AWGN   │  │Freq Off │  │ Phase   │  │Rayleigh │        │      │
│   │  │  Noise  │  │  set    │  │ Offset  │  │ Fading  │        │      │
│   │  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘        │      │
│   │       └────────────┴────────────┴────────────┘              │      │
│   │                           │                                  │      │
│   └───────────────────────────┼──────────────────────────────────┘      │
│                               │                                          │
│                               ▼                                          │
│                    ┌───────────────────────┐                             │
│                    │   Train/Val/Test      │                             │
│                    │   Split (70/15/15)    │                             │
│                    └───────────┬───────────┘                             │
│                                │                                         │
└────────────────────────────────┼─────────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                            MODEL TRAINING                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│        ┌─────────────────────────────────────────────────────┐          │
│        │              SignalClassifier (CNN+LSTM)            │          │
│        ├─────────────────────────────────────────────────────┤          │
│        │                                                     │          │
│        │  Input: (batch, 2, 128) ─── I/Q Complex Samples    │          │
│        │           │                                         │          │
│        │           ▼                                         │          │
│        │  ┌─────────────────────┐                           │          │
│        │  │   Conv1D Block 1    │ 64 filters, k=7           │          │
│        │  │   BatchNorm + ReLU  │                           │          │
│        │  │   MaxPool1D         │                           │          │
│        │  └──────────┬──────────┘                           │          │
│        │             │                                       │          │
│        │             ▼                                       │          │
│        │  ┌─────────────────────┐                           │          │
│        │  │   Conv1D Block 2    │ 128 filters, k=5          │          │
│        │  │   BatchNorm + ReLU  │                           │          │
│        │  │   MaxPool1D         │                           │          │
│        │  └──────────┬──────────┘                           │          │
│        │             │                                       │          │
│        │             ▼                                       │          │
│        │  ┌─────────────────────┐                           │          │
│        │  │   Bidirectional     │ 128 units                 │          │
│        │  │   LSTM Layer        │                           │          │
│        │  └──────────┬──────────┘                           │          │
│        │             │                                       │          │
│        │             ▼                                       │          │
│        │  ┌─────────────────────┐                           │          │
│        │  │   Dense + Softmax   │ num_classes output        │          │
│        │  └──────────┬──────────┘                           │          │
│        │             │                                       │          │
│        │  Output: Class Probabilities                        │          │
│        │                                                     │          │
│        └─────────────────────────────────────────────────────┘          │
│                                                                          │
│                       ┌─────────────────┐                               │
│                       │   Federated     │                               │
│                       │   Learning      │◄──── Differential Privacy    │
│                       │   Coordinator   │                               │
│                       └─────────────────┘                               │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
                                 │
                                 ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                             INFERENCE                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   Real-time Input ─────► Model ─────► Classification ─────► Action     │
│                                           │                              │
│                                     ┌─────┴─────┐                       │
│                                     │ >95% Acc  │                       │
│                                     └───────────┘                       │
│                                                                          │
│   Signal Types: GSM, LTE, 5G NR, WiFi, Bluetooth, Noise                 │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

### Post-Quantum Cryptography Flow

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    POST-QUANTUM CRYPTOGRAPHY FLOW                        │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                       THREAT ASSESSMENT                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│   Current Crypto ──────────────► Quantum Threat Analyzer                │
│                                         │                                │
│                           ┌─────────────┴─────────────┐                 │
│                           ▼                           ▼                 │
│                  ┌─────────────────┐        ┌─────────────────┐        │
│                  │  Shor-Vulnerable│        │ Grover-Affected │        │
│                  │  RSA, ECDSA, DH │        │  AES, SHA       │        │
│                  └────────┬────────┘        └────────┬────────┘        │
│                           │                          │                  │
│                           ▼                          ▼                  │
│                  ┌─────────────────┐        ┌─────────────────┐        │
│                  │   BROKEN by     │        │   Weakened      │        │
│                  │ Quantum Computer│        │  (halved bits)  │        │
│                  └─────────────────┘        └─────────────────┘        │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                     POST-QUANTUM MIGRATION                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                          │
│  ┌─────────────────────────────────────────────────────────────┐        │
│  │                    HYBRID SCHEME                            │        │
│  │                                                             │        │
│  │   Classical (X25519) ───┐                                   │        │
│  │                         ├──► KDF(ss1 || ss2) ──► Shared Key│        │
│  │   Post-Quantum (Kyber) ─┘                                   │        │
│  │                                                             │        │
│  └─────────────────────────────────────────────────────────────┘        │
│                                                                          │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐         │
│  │  CRYSTALS-Kyber │  │CRYSTALS-Dilithium│  │    SPHINCS+    │         │
│  │   (KEM)         │  │  (Signatures)   │  │  (Signatures)  │         │
│  ├─────────────────┤  ├─────────────────┤  ├─────────────────┤         │
│  │ Kyber-512  L1   │  │ Dilithium-2 L2  │  │ SPHINCS-128s   │         │
│  │ Kyber-768  L3   │  │ Dilithium-3 L3  │  │ SPHINCS-192s   │         │
│  │ Kyber-1024 L5   │  │ Dilithium-5 L5  │  │ SPHINCS-256s   │         │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘         │
│         │                    │                    │                     │
│         │                    │                    │                     │
│         └────────────────────┴────────────────────┘                     │
│                              │                                          │
│                              ▼                                          │
│                   ┌───────────────────────┐                            │
│                   │   Quantum-Resistant   │                            │
│                   │   Communications      │                            │
│                   └───────────────────────┘                            │
│                                                                          │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## Component Dependencies

### Core Module Dependencies

| Module | Direct Dependencies | Indirect Dependencies |
|--------|--------------------|-----------------------|
| `orchestrator` | config, logger, crypto, health | circuit_breaker, async_monitor |
| `gsm_monitor` | sdr, logger, circuit_breaker | subprocess, gr-gsm |
| `lte_monitor` | sdr, logger, circuit_breaker | subprocess, srsRAN |
| `signal_classifier` | numpy, tensorflow | dataset_loader, federated_coordinator |
| `geolocation_3d` | numpy, scipy | ntn_modeler |
| `exploit_engine` | scapy, crypto | circuit_breaker |
| `post_quantum` | numpy | - |

### External Dependencies

```
Required:
├── numpy>=1.24.0
├── scipy>=1.10.0
├── flask>=3.0.0
├── scapy>=2.5.0
└── pyyaml>=6.0

AI/ML (Optional):
├── tensorflow>=2.12.0
├── transformers>=4.30.0
├── ray[rllib]>=2.5.0
└── hypothesis>=6.0.0

Security (Optional):
├── bcrypt>=4.0.0
├── pysqlcipher3>=1.0.0
└── flask-login>=0.6.0

SDR Tools (System):
├── gnuradio>=3.10
├── gr-gsm>=0.42
├── srsRAN>=23.04
└── osmocom-bb
```

---

## Security Boundaries

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         SECURITY BOUNDARIES                              │
└─────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│ TRUST BOUNDARY: User Interface                                          │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │  • Authentication required (flask-login)                            │ │
│ │  • Rate limiting on API endpoints                                   │ │
│ │  • Input validation on all parameters                               │ │
│ │  • CSRF protection enabled                                          │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────┐
│ TRUST BOUNDARY: Core Application                                        │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │  • Circuit breakers prevent cascade failures                        │ │
│ │  • Subprocess sandboxing with timeouts                              │ │
│ │  • Encrypted database storage (SQLCipher)                           │ │
│ │  • Secret key management via environment                            │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────┐
│ TRUST BOUNDARY: System Integration                                      │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │  • Protected subprocess execution                                   │ │
│ │  • SDR tool command whitelisting                                    │ │
│ │  • File path sanitization                                           │ │
│ │  • Resource limits enforced                                         │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────┐
│ TRUST BOUNDARY: External Systems                                        │
│ ┌─────────────────────────────────────────────────────────────────────┐ │
│ │  • Network traffic encryption (TLS 1.3)                             │ │
│ │  • Post-quantum key exchange for future-proofing                    │ │
│ │  • Webhook HMAC authentication                                      │ │
│ │  • Cloud provider credential isolation                              │ │
│ └─────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## Performance Characteristics

| Component | Latency (p50) | Latency (p99) | Throughput |
|-----------|---------------|---------------|------------|
| Dashboard Load | 150ms | 500ms | 100 req/s |
| IMSI Detection | 50ms | 200ms | 1000/s |
| Signal Classification | 10ms | 50ms | 10000/s |
| 3D Geolocation | 100ms | 500ms | 100/s |
| Kyber-768 KeyGen | 1ms | 5ms | 1000/s |
| Kyber-768 Encaps | 0.5ms | 2ms | 2000/s |

---

*Last Updated: v1.9.2 - January 2026*
